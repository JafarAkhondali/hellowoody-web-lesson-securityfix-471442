<!DOCTYPE html>
<html>
    <head>
        <title>vue3 组合api知识点</title>
        <script src="https://unpkg.com/vue@next"></script>
    </head>
    <body>
        <div id="app">
        </div>
    </body>
</html>
<script>
/*
区别
1.vue3 使用时不再new vue()了，而是使用静态方法createApp
2.vue3 语法的核心思想时函数式编程，而vue2约定配置式编程
3.vue3 组合api中 不存在this
4.vue3 在template中既可以使用vue2声明的data以及mehtods，同时也可以使用setup中的return后的属性和方法。
        但是在setup中，你不能拿到vue2声明的data以及mehtods
        setup
        beforeCreate
        created
        mounted
5.vue3 template中不再强制根节点的要求
6.vue3 vue3是在vue2基础上做了优化
        运行时速度快,在版本3中，你可以声明不需要双向绑定的变量（这个变量不会被监控），同时这个变量也可以在模板中直接使用

        云开发clound（docker 虚拟机 分布式） k8s 2.5w 
        serverless无服务 11ty deno react vue3.2 
7.vue3 声明双向绑定变量的方式一共有两种 ref and reactive
        - ref是在reactive基础上的一层封装
        - 用reactive创建双向绑定变量时不能传基本类型（简单类型） string number boolean
        - 用ref创建时，可以传入任何类型（基本类型，引用类型）

备注:js类型中，基本类型 （string number boolean） <-> 引用类型 (json object ,array)
*/  

const Comp = {
    setup(){
        let a = "1"
        const b = Vue.ref("hello")
        const c = Vue.reactive({
            name:"zhang",
            age:100
        })
        const c2 = Vue.ref({
            name:"li",
            age:90
        })
        const changeA= () => {
            a = "10"
            console.log(a)
        }
        const changeB = () => {
            b.value = "你好"
        }
        let reactive_var_bad = Vue.reactive(1) //错误示范
        const reactive_var_good = Vue.reactive({val:1,type:"number"})
        const change_reactive_var = () => {
            // bad
            console.log(reactive_var_bad) // 1
            reactive_var_bad = 2
            // good
            console.log(reactive_var_good)
            reactive_var_good.val = "100"
            reactive_var_good.type = "string"
        }
        const price_reactive = Vue.reactive({value:1000})
        const price_ref = Vue.ref(2000)  // {value:2000}
        const price_ref_2 = Vue.ref({val:3000})  // 假设你忘记 ref reactive  // {value:{val:3000}}

        const changePrice = () => {
            console.log(price_reactive)
            price_reactive.value += 1
            console.log(price_ref)
            price_ref.value += 1
        }
        
        return {
            a,
            b,
            c,
            c2,
            reactive_var_bad,
            reactive_var_good,
            price_reactive,
            price_ref,
            price_ref_2,
            changeA,
            changeB,
            change_reactive_var,
            changePrice
        }
    },
    template:`
        <div>{{a}}</div>
        <div>{{b}}</div>
        <div>{{c.name}}，{{c.age}}</div>
        <div>{{c2.name}}，{{c2.age}}</div>
        <hr>
        <div>{{reactive_var_bad}}</div>
        <div>{{reactive_var_good.val}},{{reactive_var_good.type}}</div>
        <hr>
        <div>reactive价格:{{price_reactive.value}}</div>
        <div>ref价格:{{price_ref}}</div>
        <div>ref价格:{{price_ref_2.val}}</div>
        <button @click="changeA">change a</button>
        <button @click="changeB">change b</button>
        <button @click="change_reactive_var">change reactive_var</button>
        <br>
        <button @click="changePrice">change price</button>
    `
}

const app = Vue.createApp(Comp); // not options obj param ， it is component
app.mount("#app"); // 挂载到body标签中的某个节点
</script>