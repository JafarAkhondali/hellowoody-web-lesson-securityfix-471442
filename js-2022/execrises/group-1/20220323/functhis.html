<script>
window.identity = "i am window";
const object = {
    identity:"i am object",
    getId:function(){
        return function(){
            return this.identity
        }
    }
}  

const fn = object.getId()
console.log(fn())  // window

// 方案一 快照的方式

window.identity_pic = "i am window";
const object_pic = {
    identity_pic:"i am object",
    getId:function(){
        const that = this;
        return function(){
            console.log("that",that)
            console.log("this",this)
            return that.identity_pic
        }
    }
} 
const fn_pic = object_pic.getId()
console.log(fn_pic())  // object

// 方案二 我们可以主动的将任意上下文指定到普通函数中
// call apply bind

function foo(p1,p2){
    console.log(this,p1,p2)
}

foo("一","二"); //window
const obj = {
    a:1,
    b:2
}
foo.call(obj,"三","四")
foo.apply(obj,["五","六"])

const foo_new = foo.bind(obj)
foo_new("七","八")

foo.bind(obj)("九","十")


const fn_handle = object.getId()
console.log(fn_handle()) // window
console.log(fn_handle.call(object)) // object
const o = {
    identity:1000
}
console.log(fn_handle.apply(o))     // 1000
const oo = {
    identity:"我是bind那个方法的"
}
console.log(fn_handle.bind(oo)())  // 我是bind那个方法的


</script>